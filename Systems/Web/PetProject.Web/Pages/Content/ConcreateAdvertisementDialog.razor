@using PetProject.Web.Pages.Advertisement.Models.Advertisement
@using PetProject.Web.Pages.Advertisement.Services.Advertisement
@inherits MudComponentBase

@inject IAdvertisementService advertisementService

<MudDialog>
    <DialogContent>
        <MudForm Model="model" @ref="form">
            <MudGrid>

                <MudItem xs="12">
                    <MudImage
                        Width="200"
                        Height="150"
                        Src="http://t0.gstatic.com/licensed-image?q=tbn:ANd9GcQkrjYxSfSHeCEA7hkPy8e2JphDsfFHZVKqx-3t37E4XKr-AT7DML8IwtwY0TnZsUcQ" 
                        Alt="Mony the dog"
                        Elevation="25" 
                        Class="rounded-lg" />
                </MudItem>

                <MudItem xs="12">
                    <MudTextField Label="Имя" @bind-Value="model.PetName"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.DriveFileRenameOutline"
                                  For="@(() => model.PetName)">
                    </MudTextField>
                </MudItem>


                <MudItem xs="12" >
                    <MudTextField Label="Описание"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.Description"
                                  For="@(() => model.PetDescription)"
                                  @bind-Value="model.PetDescription">
                    </MudTextField>
                </MudItem>


                <MudItem xs="12" >
                    <MudTextField Label="Вознаграждение"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.CurrencyRuble"
                                  For="@(() => model.Price)"
                                  @bind-Value="model.Price">
                    </MudTextField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudTextField Label="Цвет"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.Palette"
                                  For="@(() => model.PetColor)"
                                  @bind-Value="model.PetColor">
                    </MudTextField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudTextField Label="Тип"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.GeneratingTokens"
                                  For="@(() => model.PetType)"
                                  @bind-Value="model.PetType">
                    </MudTextField>
                </MudItem>



                <MudItem xs="12" sm="6">
                    <MudTextField Label="Порода"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.Interests"
                                  For="@(() => model.PetBreed)"
                                  @bind-Value="model.PetBreed">
                    </MudTextField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudTextField Label="Возраст"
                                  For="@(() => model.Age)"
                                  @bind-Value="model.Age">
                    </MudTextField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudTextField Label="Дата"
                                  For="@(() => model.DateLost)"
                                  @bind-Value="model.DateLost">
                    </MudTextField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudTextField Label="Город"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.LocationCity"
                                  For="@(() => model.City)"
                                  @bind-Value="model.City">
                    </MudTextField>
                </MudItem>


            </MudGrid>
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Отмена</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter]
    MudDialogInstance MudDialog { get; set; } = default!;

    MudForm form = default!;

    bool isNew = false;

    [Parameter]
    public int? AdvertisementId { get; set; } = default;


    public AdvertisementResponse model { get; set; } = new AdvertisementResponse();

    protected override async Task OnInitializedAsync()
    { 

        var advertisement = await advertisementService.GetAdvertisement(AdvertisementId ?? 0);

        model.PetName = advertisement.PetName;
        model.PetDescription = advertisement.PetDescription;
        model.Price = advertisement.Price;
        model.Id = advertisement.Id;
        model.PetType = advertisement.PetType;
        model.PetTypeId = advertisement.PetTypeId;
        model.PetBreed = advertisement.PetBreed;
        model.PetBreedId = advertisement.PetBreedId;
        model.PetColorId = advertisement.PetColorId;     
        model.PetColor = advertisement.PetColor;
        model.Age = advertisement.Age;
        model.CityId = advertisement.CityId;
        model.City = advertisement.City;
        model.DateLost = advertisement.DateLost;
    }    

    void Cancel() => MudDialog.Cancel();
}